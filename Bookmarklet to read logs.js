javascript:(function(){try{var KEY='bookingTimes';var USE_UTC=false;var SORT_ASC=true;function pad(n,l){n=String(n);while(n.length<l)n='0'+n;return n;}function fmt(d){if(USE_UTC){return pad(d.getUTCDate(),2)+'/'+pad(d.getUTCMonth()+1,2)+'/'+pad(d.getUTCFullYear(),4)+','+pad(d.getUTCHours(),2)+','+pad(d.getUTCMinutes(),2)+','+pad(d.getUTCSeconds(),2)+'.'+pad(d.getUTCMilliseconds(),3);}else{return pad(d.getDate(),2)+'/'+pad(d.getMonth()+1,2)+'/'+pad(d.getFullYear(),4)+','+pad(d.getHours(),2)+','+pad(d.getMinutes(),2)+','+pad(d.getSeconds(),2)+'.'+pad(d.getMilliseconds(),3);}}var raw=localStorage.getItem(KEY);if(!raw){alert('No data under key: '+KEY);return;}var arr;try{arr=JSON.parse(raw);}catch(e){arr=null;}if(!arr||!arr.length){alert('Empty/invalid JSON under '+KEY);return;}var rows=[],skipped=0;for(var i=0;i<arr.length;i++){var it=arr[i];var d=null;if(it&&typeof it==='object'){if(typeof it.epochMsHp==='number'&&isFinite(it.epochMsHp)){d=new Date(it.epochMsHp);}else if(typeof it.iso==='string'&&it.iso){d=new Date(it.iso);}else{d=null;}}if(d&&isFinite(d.getTime())){rows.push({t:d.getTime(),s:fmt(d)});}else{skipped++;}}if(!rows.length){alert('No parseable entries. Skipped='+skipped);return;}if(SORT_ASC){rows.sort(function(a,b){return a.t-b.t;});}var text=rows.map(function(r){return r.s;}).join('\r\n');alert('Parsed entries:\r\n\r\n'+text);if(navigator.clipboard&&navigator.clipboard.writeText){navigator.clipboard.writeText(text).then(function(){alert('Copied '+rows.length+' row(s) to clipboard.');},function(){prompt('Copy the CSV:',text);});}else{prompt('Copy the CSV:',text);} }catch(err){alert('Bookmarklet error: '+err.message);}})();
